{% extends 'global/base.html' %}

{% block title %} Cadastrar Funcionário | {% endblock title %}

{% block content %}
{% include 'dashboard/pages/employee/components/_styles.html' %}

<div class="form-container">
    
    <div class="form-header">
        <h2 style="margin: 0;">{{ title|default:"Cadastrar Funcionário" }}</h2>

        {% if form.instance.pk %}
        <div class="dropdown">
            <button type="button" class="btn-dropdown-trigger">
                <i class="fa fa-print"></i> Gerar Documento <i class="fa fa-caret-down"></i>
            </button>
            <div class="dropdown-content">
                <a href="{% url 'rhcontrol:employee_registration_pdf' pk=form.instance.pk %}" target="_blank">
                    <i class="fa fa-id-card-o"></i> Ficha Cadastral
                    <i class="fa fa-external-link" style="font-size: 0.75rem; margin-left: 3px;"></i>
                </a>
                <a href="{% url 'rhcontrol:confidenciality_term_pdf' pk=form.instance.pk %}" target="_blank">
                    <i class="fa fa-file-text-o"></i> Termo de Confidencialidade
                    <i class="fa fa-external-link" style="font-size: 0.75rem; margin-left: 3px;"></i>
                </a>
                
                </div>
        </div>
        {% endif %}
    </div>

    <form method="POST" id="employeeForm" data-jobs-url="{% url 'rhcontrol:ajax_load_job_titles' %}" novalidate>
        {% csrf_token %}
        
        {% include 'dashboard/pages/employee/components/_form_fields.html' %}

        <div class="form-buttons">
            <button type="submit" class="btn-save">Salvar Cadastro</button>

            {% if form.instance.pk %}
                <a href="{% url 'rhcontrol:employee_delete' pk=form.instance.pk %}" class="btn-delete" onclick="event.preventDefault(); openDeleteModal(this.href);">
                    <i class="fa fa-trash"></i> Excluir Funcionário
                </a>
            {% endif %}
        </div>
    </form>
</div>

{% if history_enabled %}
    {% include 'dashboard/pages/employee/components/_history.html' %}
{% endif %}

    <dialog id="deleteModal" class="delete-dialog">
        <div class="dialog-content">
            <i class="fa fa-exclamation-circle" style="font-size: 3rem; color: #dc3545; margin-bottom: 10px;"></i>
            <h3>Excluir Registro?</h3>
            <p>Essa ação não poderá ser desfeita.</p>
            
            <div class="dialog-actions">
                <button onclick="closeDeleteModal()" class="btn-cancel-modal">Cancelar</button>
                <a id="btnConfirmDelete" href="#" class="btn-confirm-modal">Sim, Excluir</a>
            </div>
        </div>
    </dialog>

{% include 'dashboard/pages/employee/components/_scripts.html' %}
{% endblock %}